<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ICPP 관리 페이지</title>
  <link rel="stylesheet" href="./styles/style.css">
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js/dist/umd/supabase.min.js"></script>
  <script src="./js/supabase.js"></script>
</head>
<body class="dashboard-home">
  <h1>Integrated Chronic Pain Profile, ICPP</h1>
  <p id="userInfo"></p>

  <!-- 버튼 섹션 -->
  <button id="startAssessment">평가하기</button>
  <button id="startReassessment">재평가 설문</button>
  <button id="viewHistory">평가 기록 보기</button>
  <button id="logoutBtn">로그아웃</button>

  <script>
    // 세션 확인 및 사용자 정보 표시
    window.addEventListener("DOMContentLoaded", async () => {
      const session = await getSession();
      if (!session) {
        alert("로그인이 필요합니다.");
        window.location.href = "index.html";
        return;
      }

      const user = session.user;
      document.getElementById("userInfo").textContent = `${user.email}`;
    });

    // 평가 설문 페이지로 이동
    document.getElementById("startAssessment").addEventListener("click", () => {
      window.location.href = "dashboard.html"; // 평가 설문 페이지로 이동
    });

    // 재평가 설문 페이지로 이동
    document.getElementById("startReassessment").addEventListener("click", () => {
      window.location.href = "reassessment.html"; // 재평가 페이지로 이동
    });

    // 평가 기록 보기 페이지로 이동
    document.getElementById("viewHistory").addEventListener("click", () => {
      window.location.href = "evaluation_history.html"; // 평가 기록 보기 페이지로 이동
    });

    // 로그아웃 기능
    document.getElementById("logoutBtn").addEventListener("click", async () => {
      await logout();
      window.location.href = "index.html";
    });
  </script>
</body>
</html>
